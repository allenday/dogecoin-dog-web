<!DOCTYPE HTML>
<html>
	<head>
		<title>DogeTage</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner">

							<!-- Logo -->
								<a href="index.html" class="logo">
									<span class="symbol"><img src="../images/logo.svg" alt="" /></span><span class="title">DogeTag</span>
								</a>


						</div>
					</header>

				<!-- Main -->
					<div id="main" style="width:80%; margin:0 auto;">
						<div class="inner"> 
							<header>
								<h1>User: <span id="tweeterUsername"></span></h1>
							</header>

                            <!-- INFO SECTION -->
							<section id='tweet-data' style='display: none;'>
                                <h4><a href="" id="tweet-url">My tweet here</a></h4>
                            </section>                            

                            <!--QR SECTION-->
                            <section id='qr-data' style='display: none;'>
                                <div id="qrcode-pk"></div>                                
                            </section>

						</div>
					</div>

				<!-- Footer -->
					<footer id="footer">
						<div class="inner">							
							<section>
								<h2>Follow</h2>
								<ul class="icons">
									<li><a href="#" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li>
									<li><a href="#" class="icon brands style2 fa-facebook-f"><span class="label">Facebook</span></a></li>
									<li><a href="#" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li>									
									<li><a href="#" class="icon solid style2 fa-envelope"><span class="label">Email</span></a></li>
								</ul>
							</section>
							<ul class="copyright">
								<li>&copy; DogeTag. All rights reserved</li><li>2021</li>
							</ul>
						</div>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
            <script src="../dist/easy.qrcode.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

            <script>

                $(document).ready(function () {
                    var publicKey = window.location.pathname.replace('/addr/', '');

                    $.ajax({
                            type: "GET",
                            url: "/api/addr/" + publicKey,                            
                            dataType: "json",
                            encode: true,
                    }).done(function (user) {
                        console.log(user);
                        if (user.error !== undefined) {
                            $('#tweeterUsername').text("not found");
                        } else {
                            $('#tweeterUsername').text(user.username);

                            var optionsPublic = {
                                    text: user.publicKey,
                                    title: 'DogeTag',
                                    titleFont: "normal normal bold 48px Arial",
                                    titleColor: "#000",
                                    titleBackgroundColor: "#fff",
                                    titleHeight: 70,
                                    titleTop:55,
                                    subTitle: 'public key',
                                    subTitleFont: "normal normal normal 14px Arial",
                                    subTitleColor: "#000",
                                    subTitleTop: 10
                            };

                            new QRCode(document.getElementById("qrcode-pk"), optionsPublic);
                            $('#qr-data').show();

                            if (user.tweetUrl.length > 0) {
                                $('#tweet-url').attr("href", user.tweetUrl);
                                $('#tweet-data').show();
                            }
                        }                        
                    });
/*
                    $("form").submit(function (event) {
                        var userData = {
                            twitter: $("#twitter").val(),
                            dogname: $("#dogname").val()
                        };
        
                        $.ajax({
                            type: "GET",
                            url: "/api/user",
                            data: userData,
                            dataType: "json",
                            encode: true,
                        }).done(function (user) {
                            console.log(user);
                            
                            var optionsPublic = {
                                text: user.publicKey,
                                logo:"dist/dlogo.png",
                                title: 'DogeTag',
                                titleFont: "normal normal bold 48px Arial",
                                titleColor: "#000",
                                titleBackgroundColor: "#fff",
                                titleHeight: 70,
                                titleTop:55,
                                subTitle: 'public key',
                                subTitleFont: "normal normal normal 14px Arial",
                                subTitleColor: "#000",
                                subTitleTop: 10,
                            };

                            var optionsSecret = {
                                text: user.secretKey,
                                logo:"dist/dlogo.png",
                                title: 'DogeTag',
                                titleFont: "normal normal bold 48px Arial",
                                titleColor: "#000",
                                titleBackgroundColor: "#fff",
                                titleHeight: 70,
                                titleTop:55,
                                subTitle: 'secret key',
                                subTitleFont: "normal normal normal 14px Arial",
                                subTitleColor: "#000",
                                subTitleTop: 10,
                            };
                                            
                            new QRCode(document.getElementById("qrcode-pk"), optionsPublic);
                            new QRCode(document.getElementById("qrcode-sk"), optionsSecret);
                            $('#pkid').text('Public key: ' + user.publicKey);
                            $('#skid').text('Secret key: ' + user.secretKey);
                            var tweetMessage = user.username +' joined #proofOfDog #KYD. Sign Message: '+ user.message;
                            $('#tweet').text(tweetMessage);
                            var tweetUrl = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent('@' + tweetMessage);
                            $('#twitter-hashtag-button').attr("href", tweetUrl);
                            $('#qr-data').show();
                            $('#wallet-data').show();
                            
                        });
        
                        event.preventDefault();
                    });
*/

                });                  
        
            </script>    

	</body>
</html>