<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>DogeCoin</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <!--
  <link rel="stylesheet" href="css/styles.css?v=1.0">
  -->

</head>

<body>
    <div style='margin:0 auto; width:500px;'>
        <h1>New user</h1>
  
        <form action="" method="POST">
            <div id="twitter-group" class="form-group">
                <label for="twitter">Twitter username: </label>
                <input
                type="text"
                class="form-control"
                id="twitter"
                name="twitter"
                placeholder="@username"
                />
            </div>
  
            <div id="dogname-group" class="form-group">
                <label for="dogname">Dog Name: </label>
                <input
                type="text"
                class="form-control"
                id="dogname"
                name="dogname"
                placeholder="Jack"
                />
            </div>
    
            <button type="submit" class="btn btn-success">
                Submit
            </button>
        </form>
    </div>

    <div style='margin:0 auto; width:500px;'>
        <h1>DOGECOIN</h1>
        <div id="qrcode"></div>
        <br/>
        <div id="pkid"></div>
        <div id="skid"></div>
        <br/>
        <div id="tweet"></div>    
        <br/>
        <a href="https://twitter.com/intent/tweet?text=My%20aura%20is%20blue.%20Discover%20your%20aura%20at%20http://www.carolynmcneillie.com/colours%20pic.twitter.com/E3SdsiIqPr%20@carolynalive" target="_blank"><span class="fa fa-twitter">TWEET</span></a>
    </div>        
    
    <script src="/dist/jquery.js"></script>
    <script src="/dist/easy.qrcode.min.js"></script>
    <script>

        function requestQrCode() {
            fetch('api/create/wallet').then(function(response) {
                response.json().then(function(user) {
                    console.log(user);
                
                    var options = {
                        text: user.pk,
                        logo:"dist/dlogo.png",
                        title: 'DogeTag',
                        titleFont: "normal normal bold 48px Arial",
                        titleColor: "#000",
                        titleBackgroundColor: "#fff",
                        titleHeight: 70,
                        titleTop:45,
                    };
                                    
                    new QRCode(document.getElementById("qrcode"), options);
                    $('#pkid').text(user.pk);
                    var tweetMessage = user.username +' joined #KYD. SIGN MSG: '+ user.message;
                    console.log(tweetMessage);
                    $('#tweet').text(tweetMessage);
                });
            });
        }      
        
        $(document).ready(function () {
            $("form").submit(function (event) {
                var userData = {
                    twitter: $("#twitter").val(),
                    dogname: $("#dogname").val()
                };

                $.ajax({
                    type: "GET",
                    url: "/api/create/user",
                    data: userData,
                    dataType: "json",
                    encode: true,
                }).done(function (user) {
                    console.log(user);
                    
                    var options = {
                        text: user.pk,
                        logo:"dist/dlogo.png",
                        title: 'DogeTag',
                        titleFont: "normal normal bold 48px Arial",
                        titleColor: "#000",
                        titleBackgroundColor: "#fff",
                        titleHeight: 70,
                        titleTop:45,
                    };
                                    
                    new QRCode(document.getElementById("qrcode"), options);
                    $('#pkid').text('Public key: ' + user.pk);
                    $('#skid').text('Secret key: ' + user.sk);
                    var tweetMessage = user.username +' joined #KYD. SIGN MSG: '+ user.message;
                    $('#tweet').text(tweetMessage);
                });

                event.preventDefault();
            });
        });                  

    </script>    
</body>
</html>