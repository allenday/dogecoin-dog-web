<!DOCTYPE HTML>
<html>
	<head>
		<title>DogeTag</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner">

							<!-- Logo -->
								<a href="index.html" class="logo">
									<span class="symbol"><img src="images/logo.svg" alt="" /></span><span class="title">DogeTag</span>
								</a>


						</div>
					</header>

				<!-- Main -->
					<div id="main" style="width:80%; margin:0 auto;">
						<div class="inner"> 
							<header>
								<h1>This is DogeTag, blah-blah-blah<br />
                                blah-blah-blah by <a href="http://">Project</a>.</h1>
								<p>Etiam quis viverra lorem, in semper lorem. Sed nisl arcu euismod sit amet nisi euismod sed cursus arcu elementum ipsum arcu vivamus quis venenatis orci lorem ipsum et magna feugiat veroeros aliquam. Lorem ipsum dolor sit amet nullam dolore.</p>
							</header>

                            <!-- INFO SECTION -->
							<section>
                                <h3>Blockquote</h3>
								<blockquote>Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan faucibus. Vestibulum ante ipsum primis in faucibus lorem ipsum dolor sit amet nullam adipiscing eu felis.</blockquote>
                            </section>

                            <!-- FORM SECTION -->
                            <section>
                                <h2>Join DogeTag</h2>
                                <form method="post" action="#">
                                    <div class="row gtr-uniform">
                                        <div class="col-6 col-12-xsmall">
                                            <input type="text" name="twitter" id="twitter" value="" placeholder="What's your Twitter @username?" required/>
                                        </div>
                                        <div class="col-6 col-12-xsmall">
                                            <input type="text" name="dogname" id="dogname" value="" placeholder="What's your dog's name?" required />
                                        </div>
                                        
                                        <div class="col-12">
                                            <ul class="actions">
                                                <li><input type="submit" value="Submit" class="primary" style="background-color:#00DD00"/></li>
                                                <li><input type="reset" value="Reset" /></li>
                                            </ul>
                                        </div>

                                    </div>
                                </form>
                            </section>

                            <!--QR SECTION-->
                            <section id='qr-data' style='display: none;'>
                                <div class="box alt">
                                    <div class="row gtr-uniform">                                        
                                        <div class="col-6">
                                            <span class="image fit">
                                                <div id="qrcode-pk"></div>
                                                <a id="downloadpk" download="pk.png">
                                                    <button type="button" onClick="downloadpk()" class="button primary" style="background-color:#00DD00">Save Public Key</button>
                                                </a>
                                            </span>
                                        </div>
                                        <div class="col-6">
                                            <span class="image fit">
                                                <div id="qrcode-sk"></div>
                                                <a id="downloadsk" download="sk.png">
                                                    <button type="button" onClick="downloadsk()" class="button primary" style="background-color:#DD0000">Save Private Key</button>
                                                </a>
                                            </span>
                                        </div>                                        
                                    </div>
                                </div>                                
                            </section>

                            <section id='wallet-data' style='display: none;'>
                                <div id="pkid"></div>
                                <div id="skid"></div>
                                <br/>
                                <h3>Tweet message:</h3>
								<blockquote><span id="tweet"></span></blockquote>                                    
                                <br/>
                                <a href="" id="twitter-hashtag-button" target="_blank" class="button primary" >Press to TWEET</a>
                            </section>

						</div>
					</div>

				<!-- Footer -->
					<footer id="footer">
						<div class="inner">
							<section>
								<h2>Get in touch</h2>
								<form method="post" action="#">
									<div class="fields">
										<div class="field half">
											<input type="text" name="name" id="name" placeholder="Name" />
										</div>
										<div class="field half">
											<input type="email" name="email" id="email" placeholder="Email" />
										</div>
										<div class="field">
											<textarea name="message" id="message" placeholder="Message"></textarea>
										</div>
									</div>
									<ul class="actions">
										<li><input type="submit" value="Send" class="primary" /></li>
									</ul>
								</form>
							</section>
							<section>
								<h2>Follow</h2>
								<ul class="icons">
									<li><a href="#" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li>
									<li><a href="#" class="icon brands style2 fa-facebook-f"><span class="label">Facebook</span></a></li>
									<li><a href="#" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li>									
									<li><a href="#" class="icon solid style2 fa-envelope"><span class="label">Email</span></a></li>
								</ul>
							</section>
							<ul class="copyright">
								<li>&copy; DogeTag. All rights reserved</li><li>2021</li>
							</ul>
						</div>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
            <script src="dist/easy.qrcode.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

            <script>                
                function downloadpk() {
                    var download = document.getElementById("downloadpk");
                    var image = document.getElementById("qrcode-pk").children[0]
                                        .toDataURL("image/png").replace("image/png", "image/octet-stream");
                    download.setAttribute("href", image);                    
                }

                function downloadsk() {
                    var download = document.getElementById("downloadsk");
                    var image = document.getElementById("qrcode-sk").children[0]
                                        .toDataURL("image/png").replace("image/png", "image/octet-stream");
                    download.setAttribute("href", image);                    
                }

                $(document).ready(function () {
                    $("form").submit(function (event) {
                        var userData = {
                            twitter: $("#twitter").val(),
                            dogname: $("#dogname").val()
                        };
        
                        $.ajax({
                            type: "GET",
                            url: "/api/create/user",
                            data: userData,
                            dataType: "json",
                            encode: true,
                        }).done(function (user) {
                            console.log(user);
                            
                            var optionsPublic = {
                                text: user.publicKey,
                                logo:"dist/dlogo.png",
                                title: 'DogeTag',
                                titleFont: "normal normal bold 48px Arial",
                                titleColor: "#000",
                                titleBackgroundColor: "#fff",
                                titleHeight: 70,
                                titleTop:55,
                                subTitle: 'public key',
                                subTitleFont: "normal normal normal 14px Arial",
                                subTitleColor: "#000",
                                subTitleTop: 10,
                            };

                            var optionsSecret = {
                                text: user.secretKey,
                                logo:"dist/dlogo.png",
                                title: 'DogeTag',
                                titleFont: "normal normal bold 48px Arial",
                                titleColor: "#000",
                                titleBackgroundColor: "#fff",
                                titleHeight: 70,
                                titleTop:55,
                                subTitle: 'secret key',
                                subTitleFont: "normal normal normal 14px Arial",
                                subTitleColor: "#000",
                                subTitleTop: 10,
                            };
                                            
                            new QRCode(document.getElementById("qrcode-pk"), optionsPublic);
                            new QRCode(document.getElementById("qrcode-sk"), optionsSecret);
                            $('#pkid').text('Public key (' + user.dogname + '\'s wallet address): ' + user.publicKey);
                            $('#skid').text('Private key (keep this safe and do not share with anyone): ' + user.secretKey);
                            var tweetMessage = user.dogname + '\'s #proofOfdog\n\nsignature:\n'+ user.message + '\n#KYD';
                            $('#tweet').text(tweetMessage);
                            var tweetUrl = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent('@' + tweetMessage);
                            $('#twitter-hashtag-button').attr("href", tweetUrl);
                            $('#qr-data').show();
                            $('#wallet-data').show();
                            
                        });
        
                        event.preventDefault();
                    });
                });                  
        
            </script>    

	</body>
</html>
